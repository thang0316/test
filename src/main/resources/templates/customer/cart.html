<div class="mb-3">
    <button onclick="goBack()" class="btn btn-light">‚¨Ö Quay l·∫°i menu</button>
</div>

<h3 class="mb-3">üõí Gi·ªè h√†ng</h3>

<div id="cartBox">ƒêang t·∫£i...</div>

<script>

    /* QUAY L·∫†I */
    function goBack() {
        switchPage("dashboard");
    }

    /* CART STORAGE */
    function getCart() {
        return JSON.parse(localStorage.getItem("cart") || "[]");
    }
    function saveCart(v) {
        localStorage.setItem("cart", JSON.stringify(v));
    }

    /* HI·ªÇN TH·ªä GI·ªé H√ÄNG */
    function loadCart() {
        let cart = getCart();

        if (cart.length === 0) {
            cartBox.innerHTML = `<p class='text-muted'>Gi·ªè h√†ng tr·ªëng.</p>`;
            return;
        }

        let total = 0;
        let html = "";

        cart.forEach((i, idx) => {
            total += i.price * i.qty;

            html += `
            <div class="p-3 bg-white border rounded mb-3 d-flex">
                <img src="${i.img}" width="80" height="80" style="border-radius:10px;object-fit:cover;">

                <div class="ms-3 flex-grow-1">
                    <h5>${i.name}</h5>
                    <div class="text-danger fw-bold">${i.price.toLocaleString()}ƒë</div>

                    <div class="d-flex mt-2">
                        <button class="btn btn-sm btn-outline-secondary" onclick="changeQty(${idx}, -1)">‚àí</button>
                        <span class="mx-3">${i.qty}</span>
                        <button class="btn btn-sm btn-outline-secondary" onclick="changeQty(${idx}, 1)">+</button>
                    </div>
                </div>
            </div>
        `;
        });

        html += `
        <h4 class="text-danger">T·ªïng c·ªông: ${total.toLocaleString()}ƒë</h4>

        <button class="btn btn-danger w-100 mt-3" onclick="switchPage('checkout')">
            üëâ Ti·∫øp t·ª•c thanh to√°n
        </button>
    `;

        cartBox.innerHTML = html;
    }

    /* THAY QTY */
    function changeQty(index, delta) {
        let cart = getCart();
        cart[index].qty += delta;

        if (cart[index].qty <= 0) cart.splice(index, 1);

        saveCart(cart);
        loadCart();
    }

    loadCart();

</script>
