<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Há»“ sÆ¡ | Restaurant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body{ background:#eef2f5; font-family:"Segoe UI"; }
        .sidebar{ position:fixed; top:0; left:0; width:220px; height:100vh; background:#198754; padding-top:20px; }
        .sidebar a{ color:white; padding:12px 18px; display:block; font-weight:500; text-decoration:none; }
        .content{ margin-left:240px; padding:25px; }
        .card-box{ background:white; padding:20px; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.1); }
    </style>
</head>

<body>

<div class="sidebar">
    <a href="/restaurant/dashboard">ğŸ  Dashboard</a>
    <a href="/restaurant/menu">ğŸ• Menu</a>
    <a href="/restaurant/orders">ğŸ“¦ ÄÆ¡n hÃ ng</a>
    <a href="/restaurant/drones">ğŸ›© Drone</a>
    <a href="/restaurant/profile">ğŸ‘¤ Há»“ sÆ¡</a>
</div>

<div class="content">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3>ğŸ‘¤ Há»“ sÆ¡ NhÃ  hÃ ng</h3>
        <button class="btn btn-danger" onclick="logout()">ÄÄƒng xuáº¥t</button>
    </div>

    <div class="card-box mt-3">
        <p><b>TÃªn:</b> <span id="rName"></span></p>
        <p><b>Äá»‹a chá»‰:</b> <span id="rAddr"></span></p>
        <p><b>SÄT:</b> <span id="rPhone"></span></p>
        <p>
            <b>Tráº¡ng thÃ¡i:</b>
            <div class="form-check form-switch" style="margin-top: 8px;">
                <input class="form-check-input" type="checkbox" id="statusToggle" onchange="toggleStatus()">
                <label class="form-check-label" for="statusToggle">
                    <span id="statusLabel">ÄÃ³ng cá»­a</span>
                </label>
            </div>
        </p>
    </div>
</div>

<script>
    const id = localStorage.getItem("restaurantId");

    fetch(`/api/restaurants/${id}`)
        .then(r=>r.json())
        .then(res=>{
            rName.innerText=res.name;
            rAddr.innerText=res.address;
            rPhone.innerText=res.phone;
            
            // Set toggle status
            document.getElementById("statusToggle").checked = res.active;
            document.getElementById("statusLabel").innerText = res.active ? "Má»Ÿ cá»­a" : "ÄÃ³ng cá»­a";
        });

    function toggleStatus(){
        const isActive = document.getElementById("statusToggle").checked;
        const label = isActive ? "Má»Ÿ cá»­a" : "ÄÃ³ng cá»­a";
        
        fetch(`/api/restaurants/${id}/active?active=${isActive}`, {method: "PUT"})
            .then(r => r.json())
            .then(() => {
                document.getElementById("statusLabel").innerText = label;
                alert(`Tráº¡ng thÃ¡i: ${label}`);
            })
            .catch(err => {
                alert("Lá»—i cáº­p nháº­t tráº¡ng thÃ¡i!");
                console.error(err);
            });
    }

    function logout(){
        localStorage.clear();
        window.location.href="/login";
    }
</script>

</body>
</html>
